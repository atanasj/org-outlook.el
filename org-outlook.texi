\input texinfo
@documentencoding UTF-8

@ifnottex
@paragraphindent 0
@end ifnottex
@node Top
@top Top

@menu
* org-outlookel::
@end menu

@node org-outlookel
@chapter org-outlook.el
Matthew L. Fidler ## Library Information @emph{org-outlook.el} --- Outlook org

@itemize
@item
@strong{Filename} -- org-outlook.el Description:
@item
@strong{Author} -- Matthew L. Fidler Maintainer:
@item
@strong{Created} -- Mon May 10 09:44:59 2010 (-0500)
@item
@strong{Version} -- 0.7
@item
@strong{Last-Updated} -- Tue May 29 22:21:06 2012 (-0500)
@item
@strong{By} -- Matthew L. Fidler
@item
@strong{Update #} -- 166
@item
@strong{URL} -- https:__github.com_mlf176f2_org-outlook.el
@item
@strong{Keywords} -- Org-outlook Compatibility:
@end itemize

@menu
* Introduction::
* History::
@end menu

@node Introduction
@section Introduction:
Org mode lets you organize your tasks. However@comma{} sometimes you may wish to integrate org-mode with outlook since your company forces you to use Microsoft Outlook. org-outlook.el allows: - Creating Tasks from outlook items: - org-outlook-task. All selected items in outlook will be added to a task-list at current point. This version requires org-protocol and@* org-protocol.vbs. The org-protocol.vbs has can be generated with the interactive function @code{org-outlook-create-vbs}.

@itemize
@item
Open Outlook Links in org-mode

@item
Requires org-outlook-location to be customized when using Outlook 2007 (this way you don't have to edit the registry).

@end itemize

This is based loosely on: http:__superuser.com_questions_71786/can-i-create-a-link-to-a-specific-email-message-in-outlook

Note that you may also add tasks using visual basic directly. The script below performs the following actions:

@itemize
@item
Move email to Personal Folders under folder "@@ActionTasks" (changes GUID)
@item
Create a org-mode task under heading "* Tasks" for the file @code{f:\Documents\org\gtd.org}
@item
Note by replacing "@@ActionTasks"@comma{} "* Tasks" and @code{f:\Documents\org\gtd.org} you can modify this script to your personal needs.
@end itemize

The visual basic script for outlook is:

Sub CreateTaskFromItem() Dim T As Variant Dim Outlook As New Outlook.Application Dim orgfile As Variant Dim Pos As Integer Dim taskf As Object
@verbatim
Set myNamespace = Outlook.GetNamespace("MAPI")
Set myPersonalFolder = myNamespace.Folders.item("Personal Folders")
Set allPersonalFolders = myPersonalFolder.Folders

T = ""
For Each Folder In allPersonalFolders
    If Folder.Name = "@ActionTasks" Then
        Set taskf = Folder
        Exit For
    End If
Next

If Outlook.Application.ActiveExplorer.Selection.Count > 0 Then
    For I = 1 To Outlook.Application.ActiveExplorer.Selection.Count
            Set objMail = Outlook.ActiveExplorer.Selection.item(I)
            Set objMail = objMail.Move(taskf)
            objMail.Save 'Maybe this will update EntryID
            T = T + "____ TODO " + objMail.Subject + " :OFFICE:" + vbCrLf
            T = T + "[[outlook:" + objMail.EntryID + "][MESSAGE: " + objMail.Subject + " (" + objMail.SenderName + ")]]"
            T = T + vbCrLf + vbCrLf
            T = T + objMail.Body
            T = T + vbCrLf + vbCrLf
    Next
    ' Now that we have the org-mode tasks, add to org-mode file
    orgfile = GetFile("f:\Documents\org\gtd.org")
    Pos = InStr(1, orgfile, "* Tasks", vbTextCompare)
    orgfile = Mid(orgfile, 1, Pos + Len("__ Tasks") + 1) + vbCrLf + T + Mid(orgfile, Pos + Len("__ Tasks") + 1, Len(orgfile))
    orgfile = Replace(orgfile, vbCrLf, Chr(10)) ' Change to unix line endings.
    WriteFile "f:\Documents\org\gtd.org", orgfile
Else
    MsgBox "No Message(s) Selected"
End If
@end verbatim

End Sub

@node History
@section History
@itemize
@item
@strong{07-Dec-2012} -- Should fix Issue #1. Also added org-outlook-create-vbs to create the VBS code based on a user's setup. (Matthew L. Fidler)
@item
@strong{26-May-2012} -- Added (require 'cl)@comma{} Thanks Robert Pluim (Matthew L. Fidler)
@item
@strong{21-Feb-2012} -- Bug fix for opening files. (Matthew L. Fidler)
@item
@strong{21-Feb-2012} -- Bug fix. (Matthew L. Fidler)
@item
@strong{13-Dec-2011} -- Added more autoload cookies. (Matthew L. Fidler)
@item
@strong{08-Apr-2011} -- Added some autoload cookies. (US041375)
@item
@strong{15-Feb-2011} -- Changed outlook-org to org-outlook.el (Matthew L. Fidler)
@item
@strong{11-Jan-2011} -- Finalized interface with org-protocol (Matthew L. Fidler)
@item
@strong{05-Jan-2011} -- Removed outlook copy. I only use from outlook now. (Matthew L. Fidler)
@end itemize

@bye
